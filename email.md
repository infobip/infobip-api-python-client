# Email API example

This example demonstrates how to use the [Infobip Email API](https://www.infobip.com/docs/api/channels/email). You'll learn how to initialize an email client,
send a message, and receive a delivery report.

Initialize Send Email API client:

```python
from infobip_api_client.api_client import ApiClient, Configuration

client_config = Configuration(
    host="<YOUR_BASE_URL>",
    api_key={"APIKeyHeader": "<YOUR_API_KEY>"},
    api_key_prefix={"APIKeyHeader": "<YOUR_API_PREFIX>"},
)

api_client = ApiClient(client_config)
api_instance = EmailApi(api_client)
```

Before sending an email message, you need to verify the domain with which you will be sending emails.

## Send an Email with a file

Fields `from`, `to`, and `subject` are required. The message must also contain at least one of these: `text`, `html`, or `templateId`.

---
**IMPORTANT NOTE**

Keep in mind the following restrictions while using a trial account:

- you can only send messages to verified email addresses,
- you can only use your email address with the Infobip test domain in the following form: `YourUserName@selfserviceib.com`

---

```python
file_attachment = open("report.csv", "rb")
file_content = file_attachment.read()

api_response = api_instance.send_email(
        to=["john.smith@somedomain.com"],
        var_from="Jane Smith <jane.smith@somecompany.com>",
        subject="Mail subject text",
        text="Test message with a file",
        attachment=[file_content],
    )
```

## Delivery reports

For each message that you send out, we can send you a delivery report in real time.
All you need to do is specify your endpoint when sending email in the `notifyUrl` field.

Additionally, you can use a `messageId` or a `bulkId` autogenerated in a response for troubleshooting and to fetch reports.

```python
bulk_id = "BULK-ID-123-xyz";
number_of_reports_limits = 10;


api_response = api_instance.get_email_delivery_reports(
    bulk_id=bulk_id, limit=number_of_reports_limits
)

for report in api_response.results:
    print(f"{report.message_id} - {report.status.name}")
```